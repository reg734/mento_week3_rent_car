{% extends "base.html" %}
{% block content %}
<style>
    .tt-menu {
        background: #fff;
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, .15);
        z-index: 1051;
        min-width: 100%;
    }

    .tt-suggestion {
        padding: 0.5rem 1rem;
        cursor: pointer;
    }

    .tt-suggestion.tt-cursor,
    .tt-suggestion:hover {
        background: #f8f9fa;
    }

    .tt-suggestion:not(:last-child) {
        border-bottom: 1px solid #dee2e6;
    }
</style>
<!-- content begin -->
<div class="no-bottom no-top zebra" id="content">
    <div id="top"></div>

    <!-- section begin -->
    <section id="subheader" class="jarallax text-light">
        <img src="{{ url_for('static', filename='images/background/subheader.jpg') }}" class="jarallax-img" alt="">
        <div class="center-y relative text-center">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 text-center">
                        <h1>Booking</h1>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    </section>
    <!-- section close -->

    <section id="section-hero" aria-label="section" class="no-top mt-80 sm-mt-0">
        <div class="container">
            <div class="row align-items-center">

                <div class="col-lg-12">
                    <div class="spacer-single sm-hide"></div>
                    <div class="p-4 rounded-3 shadow-soft" data-bgcolor="#ffffff">


                        <form name="contactForm" id='contact_form' method="post">
                            <div id="step-1" class="row">
                                <div class="col-lg-6 mb30">
                                    <h5>What is your vehicle type?</h5>

                                    <div class="de_form de_radio row g-3">
                                        <div class="radio-img col-lg-3 col-sm-3 col-6">
                                            <input id="radio-1a" name="Car_Type" type="radio" value="Hatchback"
                                                checked="checked">
                                            <label for="radio-1a"><img
                                                    src="{{ url_for('static', filename='images/select-form/car.png') }}"
                                                    alt="">Hatchback</label>
                                        </div>

                                        <div class="radio-img col-lg-3 col-sm-3 col-6">
                                            <input id="radio-1b" name="Car_Type" type="radio" value="Sedan">
                                            <label for="radio-1b"><img
                                                    src="{{ url_for('static', filename='images/select-form/car.png') }}"
                                                    alt="">Sedan</label>
                                        </div>

                                        <div class="radio-img col-lg-3 col-sm-3 col-6">
                                            <input id="radio-1c" name="Car_Type" type="radio" value="SUV">
                                            <label for="radio-1c"><img
                                                    src="{{ url_for('static', filename='images/select-form/minibus.png') }}"
                                                    alt="">SUV</label>
                                        </div>

                                        <div class="radio-img col-lg-3 col-sm-3 col-6">
                                            <input id="radio-1d" name="Car_Type" type="radio" value="All">
                                            <label for="radio-1d"><img
                                                    src="{{ url_for('static', filename='images/select-form/car.png') }}"
                                                    alt="">All</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="row">
                                        <div class="col-lg-6 mb20">
                                            <h5>Pick Up Location</h5>
                                            <div class="input-group mb-2 flex-nowrap">
                                                <input type="text" name="PickupLocation" id="autocomplete"
                                                    class="form-control" placeholder="Enter your pickup location"
                                                    autocomplete="off">
                                                <button class="btn btn-outline-secondary dropdown-toggle" type="button"
                                                    data-bs-toggle="dropdown" aria-expanded="false">
                                                    選擇地點
                                                </button>
                                                <ul class="dropdown-menu dropdown-menu-end">
                                                    <li><a class="dropdown-item" href="#">台北站</a></li>
                                                    <li><a class="dropdown-item" href="#">台中站</a></li>
                                                    <li><a class="dropdown-item" href="#">高雄站</a></li>
                                                    <!-- 其他地點 -->
                                                </ul>
                                            </div>

                                            <div class="jls-address-preview jls-address-preview--hidden">
                                                <div class="jls-address-preview__header">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-lg-6 mb20">
                                            <h5>Drop Off Location</h5>
                                            <div class="input-group mb-2 flex-nowrap">
                                                <input type="text" name="DropoffLocation" id="autocomplete2"
                                                    class="form-control" placeholder="Enter your dropoff location"
                                                    autocomplete="off">
                                                <button class="btn btn-outline-secondary dropdown-toggle" type="button"
                                                    data-bs-toggle="dropdown" aria-expanded="false">
                                                    選擇地點
                                                </button>
                                                <ul class="dropdown-menu dropdown-menu-end">
                                                    <li><a class="dropdown-item" href="#">台北站</a></li>
                                                    <li><a class="dropdown-item" href="#">台中站</a></li>
                                                    <li><a class="dropdown-item" href="#">高雄站</a></li>
                                                    <!-- 其他地點 -->
                                                </ul>
                                            </div>

                                            <div class="jls-address-preview jls-address-preview--hidden">
                                                <div class="jls-address-preview__header">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-lg-6 mb20">
                                            <h5>Pick Up Date & Time</h5>
                                            <div class="date-time-field">
                                                <input type="text" id="date-picker" name="Pick Up Date" value="">
                                                <select name="Pick Up Time" id="pickup-time">
                                                    <option selected disabled value="Select time">Time</option>
                                                    <option value="00:00">00:00</option>
                                                    <option value="00:30">00:30</option>
                                                    <option value="01:00">01:00</option>
                                                    <option value="01:30">01:30</option>
                                                    <option value="02:00">02:00</option>
                                                    <option value="02:30">02:30</option>
                                                    <option value="03:00">03:00</option>
                                                    <option value="03:30">03:30</option>
                                                    <option value="04:00">04:00</option>
                                                    <option value="04:30">04:30</option>
                                                    <option value="05:00">05:00</option>
                                                    <option value="05:30">05:30</option>
                                                    <option value="06:00">06:00</option>
                                                    <option value="06:30">06:30</option>
                                                    <option value="07:00">07:00</option>
                                                    <option value="07:30">07:30</option>
                                                    <option value="08:00">08:00</option>
                                                    <option value="08:30">08:30</option>
                                                    <option value="09:00">09:00</option>
                                                    <option value="09:30">09:30</option>
                                                    <option value="10:00">10:00</option>
                                                    <option value="10:30">10:30</option>
                                                    <option value="11:00">11:00</option>
                                                    <option value="11:30">11:30</option>
                                                    <option value="12:00">12:00</option>
                                                    <option value="12:30">12:30</option>
                                                    <option value="13:00">13:00</option>
                                                    <option value="13:30">13:30</option>
                                                    <option value="14:00">14:00</option>
                                                    <option value="14:30">14:30</option>
                                                    <option value="15:00">15:00</option>
                                                    <option value="15:30">15:30</option>
                                                    <option value="16:00">16:00</option>
                                                    <option value="16:30">16:30</option>
                                                    <option value="17:00">17:00</option>
                                                    <option value="17:30">17:30</option>
                                                    <option value="18:00">18:00</option>
                                                    <option value="18:30">18:30</option>
                                                    <option value="19:00">19:00</option>
                                                    <option value="19:30">19:30</option>
                                                    <option value="20:00">20:00</option>
                                                    <option value="20:30">20:30</option>
                                                    <option value="21:00">21:00</option>
                                                    <option value="21:30">21:30</option>
                                                    <option value="22:00">22:00</option>
                                                    <option value="22:30">22:30</option>
                                                    <option value="23:00">23:00</option>
                                                    <option value="23:30">23:30</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="col-lg-6 mb20">
                                            <h5>Return Date & Time</h5>
                                            <div class="date-time-field">
                                                <input type="text" id="date-picker-2" name="Collection Date" value="">
                                                <select name="Collection Time" id="collection-time">
                                                    <option selected disabled value="Select time">Time</option>
                                                    <option value="00:00">00:00</option>
                                                    <option value="00:30">00:30</option>
                                                    <option value="01:00">01:00</option>
                                                    <option value="01:30">01:30</option>
                                                    <option value="02:00">02:00</option>
                                                    <option value="02:30">02:30</option>
                                                    <option value="03:00">03:00</option>
                                                    <option value="03:30">03:30</option>
                                                    <option value="04:00">04:00</option>
                                                    <option value="04:30">04:30</option>
                                                    <option value="05:00">05:00</option>
                                                    <option value="05:30">05:30</option>
                                                    <option value="06:00">06:00</option>
                                                    <option value="06:30">06:30</option>
                                                    <option value="07:00">07:00</option>
                                                    <option value="07:30">07:30</option>
                                                    <option value="08:00">08:00</option>
                                                    <option value="08:30">08:30</option>
                                                    <option value="09:00">09:00</option>
                                                    <option value="09:30">09:30</option>
                                                    <option value="10:00">10:00</option>
                                                    <option value="10:30">10:30</option>
                                                    <option value="11:00">11:00</option>
                                                    <option value="11:30">11:30</option>
                                                    <option value="12:00">12:00</option>
                                                    <option value="12:30">12:30</option>
                                                    <option value="13:00">13:00</option>
                                                    <option value="13:30">13:30</option>
                                                    <option value="14:00">14:00</option>
                                                    <option value="14:30">14:30</option>
                                                    <option value="15:00">15:00</option>
                                                    <option value="15:30">15:30</option>
                                                    <option value="16:00">16:00</option>
                                                    <option value="16:30">16:30</option>
                                                    <option value="17:00">17:00</option>
                                                    <option value="17:30">17:30</option>
                                                    <option value="18:00">18:00</option>
                                                    <option value="18:30">18:30</option>
                                                    <option value="19:00">19:00</option>
                                                    <option value="19:30">19:30</option>
                                                    <option value="20:00">20:00</option>
                                                    <option value="20:30">20:30</option>
                                                    <option value="21:00">21:00</option>
                                                    <option value="21:30">21:30</option>
                                                    <option value="22:00">22:00</option>
                                                    <option value="22:30">22:30</option>
                                                    <option value="23:00">23:00</option>
                                                    <option value="23:30">23:30</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <input type='submit' id='send_message' value='Find a Vehicle'
                                        class="btn-main pull-right">
                                </div>

                            </div>

                        </form>
                    </div>
                </div>
            </div>

            <div class="spacer-single"></div>

            <div class="row">

                <div class="col-md-3 wow fadeInRight" data-wow-delay=".2s">
                    <div class="feature-box style-4 text-center">
                        <a href="#"><i class="bg-color text-light i-boxed fa fa-car"></i></a>
                        <div class="text">
                            <a href="#">
                                <h4>Choose a vehicle</h4>
                            </a>
                            Unlock unparalleled adventures and memorable journeys with our vast fleet of vehicles
                            tailored to suit every need, taste, and destination.
                        </div>
                        <span class="wm">1</span>
                    </div>
                </div>

                <div class="col-md-3 wow fadeInRight" data-wow-delay=".4s">
                    <div class="feature-box style-4 text-center">
                        <a href="#"><i class="bg-color text-light i-boxed fa fa-calendar"></i></a>
                        <div class="text">
                            <a href="#">
                                <h4>Pick location &amp; date</h4>
                            </a>
                            Pick your ideal location and date, and let us take you on a journey filled with convenience,
                            flexibility, and unforgettable experiences.
                        </div>
                        <span class="wm">2</span>
                    </div>
                </div>

                <div class="col-md-3 wow fadeInRight" data-wow-delay=".6s">
                    <div class="feature-box style-4 text-center">
                        <a href="#"><i class="bg-color text-light i-boxed fa fa-pencil-square-o"></i></a>
                        <div class="text">
                            <a href="#">
                                <h4>Make a booking</h4>
                            </a>
                            Secure your reservation with ease, unlocking a world of possibilities and embarking on your
                            next adventure with confidence.
                        </div>
                        <span class="wm">3</span>
                    </div>
                </div>

                <div class="col-md-3 wow fadeInRight" data-wow-delay=".6s">
                    <div class="feature-box style-4 text-center">
                        <a href="#"><i class="bg-color text-light i-boxed fa fa-smile-o"></i></a>
                        <div class="text">
                            <a href="#">
                                <h4>Sit back & relax</h4>
                            </a>
                            Hassle-free convenience as we take care of every detail, allowing you to unwind and embrace
                            a journey filled comfort.
                        </div>
                        <span class="wm">3</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    {% if available_cars is defined and available_cars is not none and available_cars|length > 0 %}
    <!-- Modal -->
    <div class="modal fade" id="availableCarsModal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form method="post" action="/booking/confirm">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalLabel">可出租車輛</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        {% if available_cars %}
                            {% if pickup_dt and return_dt %}
                            <div class="alert alert-info mb-3">
                                <h5>租借資訊</h5>
                                <p>
                                    <strong>取車時間：</strong>{{ pickup_dt.strftime('%Y年%m月%d日 %H:%M') }}<br>
                                    <strong>還車時間：</strong>{{ return_dt.strftime('%Y年%m月%d日 %H:%M') }}<br>
                                    <strong>租賃天數：</strong>{{ rental_days }} 天
                                </p>
                            </div>
                            {% endif %}
                        {% for car in available_cars %}
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="car_id" value="{{ car.id }}"
                                id="car{{ car.id }}" required>
                            <label class="form-check-label" for="car{{ car.id }}">
                                {{ car.name }} ({{ car.body }})<br>
                                每日租金：${{ car.price }}<br>
                                {% if rental_days %}
                                總金額：${{ car.price * rental_days }}
                                {% else %}
                                總金額：${{ car.price }}
                                {% endif %}
                            </label>
                        </div>
                        {% endfor %}
                        {% else %}
                        <p>沒有可用車輛</p>
                        {% endif %}
                        <!-- 其他隱藏欄位帶入地點、時間 -->
                        <input type="hidden" name="pickup_location" value="{{ pickup_location }}">
                        <input type="hidden" name="dropoff_location" value="{{ dropoff_location }}">
                        <input type="hidden" name="pickup_date" value="{{ pickup_date }}">
                        <input type="hidden" name="pickup_time" value="{{ pickup_time }}">
                        <input type="hidden" name="return_date" value="{{ return_date }}">
                        <input type="hidden" name="return_time" value="{{ return_time }}">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                        <button type="submit" class="btn btn-primary">送出訂單</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}

    <section class="text-light jarallax">
        <img src="{{ url_for('static', filename='images/select-form/car.png') }}" class="jarallax-img" alt="">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-6 wow fadeInRight">
                    <h2>We offer customers a wide range of <span class="id-color">commercial cars</span> and <span
                            class="id-color">luxury cars</span> for any occasion.</h2>
                </div>
                <div class="col-lg-6 wow fadeInLeft">
                    At our car rental agency, we believe that everyone deserves to experience the pleasure of driving a
                    reliable and comfortable vehicle, regardless of their budget. We have curated a diverse fleet of
                    well-maintained cars, ranging from sleek sedans to spacious SUVs, all at competitive prices. With
                    our streamlined rental process, you can quickly and conveniently reserve your desired vehicle.
                    Whether you need transportation for a business trip, family vacation, or simply want to enjoy a
                    weekend getaway, we have flexible rental options to accommodate your schedule.
                </div>
            </div>
            <div class="spacer-double"></div>
            <div class="row text-center">
                <div class="col-md-3 col-sm-6 mb-sm-30">
                    <div class="de_count transparent text-light wow fadeInUp">
                        <h3 class="timer" data-to="15425" data-speed="3000">0</h3>
                        Completed Orders
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 mb-sm-30">
                    <div class="de_count transparent text-light wow fadeInUp">
                        <h3 class="timer" data-to="8745" data-speed="3000">0</h3>
                        Happy Customers
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 mb-sm-30">
                    <div class="de_count transparent text-light wow fadeInUp">
                        <h3 class="timer" data-to="235" data-speed="3000">0</h3>
                        Vehicles Fleet
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 mb-sm-30">
                    <div class="de_count transparent text-light wow fadeInUp">
                        <h3 class="timer" data-to="15" data-speed="3000">0</h3>
                        Years Experience
                    </div>
                </div>
            </div>
        </div>
    </section>


</div>
<!-- content close -->
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/corejs-typeahead/1.3.1/typeahead.bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/auto-type.js') }}"></script>
<script src="{{ url_for('static', filename='js/booking-validate.js') }}"></script>

{% if available_cars is defined and available_cars is not none and available_cars|length > 0 %}
<script>
    // 只在表單提交後才自動顯示 modal
    {% if show_modal %}
    document.addEventListener('DOMContentLoaded', function () {
        var modal = new bootstrap.Modal(document.getElementById('availableCarsModal'));
        modal.show();
    });
    {% endif %}

    // 表單提交前驗證
    document.addEventListener('DOMContentLoaded', function () {
        const modalForm = document.querySelector('#availableCarsModal form');
        if (modalForm) {
            modalForm.addEventListener('submit', function (e) {
                const carId = document.querySelector('input[name="car_id"]:checked');
                if (!carId) {
                    e.preventDefault();
                    alert('請選擇一輛車輛');
                    return false;
                }

                // 除錯：顯示要提交的資料
                console.log('提交資料:', {
                    car_id: carId.value,
                    pickup_location: document.querySelector('input[name="pickup_location"]').value,
                    dropoff_location: document.querySelector('input[name="dropoff_location"]').value,
                    pickup_date: document.querySelector('input[name="pickup_date"]').value,
                    pickup_time: document.querySelector('input[name="pickup_time"]').value,
                    return_date: document.querySelector('input[name="return_date"]').value,
                    return_time: document.querySelector('input[name="return_time"]').value
                });

                return true;
            });
        }
    });
</script>
{% endif %}
{% endblock %}